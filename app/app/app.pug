doctype html
div(layout="column" style="height: 100vh; overflow: auto")
  md-toolbar.md-whiteframe-1dp
    .md-toolbar-tools
      div(flex ng-if="!search.toggle")
        .md-title Czy Sie Oplaca
      md-button.md-icon-button(ng-click="search.toggle = true")
        md-icon search
      div(ng-if="search.toggle" layout="row" flex)
        input.search-input(type="text" autofocus flex="1" ng-model="search.query" placeholder="search")
        md-button.md-icon-button(ng-click="search.toggle = false; search.query = ''")
          md-icon close
      settings(settings="$ctrl.settings")
  md-content(flex layout-padding)
    md-card
      md-table-container
        table(md-table md-progress="$ctrl.promise")
          thead(md-head md-order="$ctrl.orderBy")
            tr(md-row)
              th(md-column md-order-by="projectKey") Project Key
              th(md-column md-order-by="name") Name
              th(md-column md-order-by="releaseDate") Deadline
              th(md-column md-numeric md-desc md-order-by="timespent['{{ group }}']" ng-repeat="group in $ctrl.groups") {{ group }}
              th(md-column md-numeric md-desc md-order-by="totalTimespent") Total
          tbody(md-body)
            tr(md-row
               ng-repeat="version in $ctrl.data | filter: search.query | orderBy: $ctrl.orderBy"
               ng-class="{'archived' : version.archived }"
               ng-if="!($ctrl.settings.hideArchived && version.archived)")
              td(md-cell): a.md-button(href="//{{ $ctrl.jiraHost }}/browse/{{ version.projectKey }}" target="_blank") {{ version.projectKey }}
              td(md-cell)
                | {{ version.name }}
                md-icon(ng-show="version.archived") delete
              td(md-cell) {{ version.releaseDate }}
              td(md-cell ng-repeat="group in $ctrl.groups" ng-click="$ctrl.editEstimate($event, version, group)")
                span(ng-show="version.estimate[group]") {{ version.timespent[group] }} / {{ version.estimate[group] }}
                span.empty-estimate(ng-show="!version.estimate[group]") {{ version.timespent[group] }}
              td(md-cell) {{ version.totalTimespent }} / {{ $ctrl.totalEstimate(version) }}
